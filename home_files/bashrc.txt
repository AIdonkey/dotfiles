# General
alias ..="cd .."
alias ...="cd ../.."
alias c="clear"
alias h="history"
alias l="ls -alh"
alias p='pwd | tr -d "\r\n" | pbcopy && echo "`pbpaste` (copied to clipboard)"'
alias o="open"
alias e="sublime"
alias home="cd $HOME"
alias tree="find . -print | sed -e 's;[^/]*/;|____;g;s;____|; |;g'"
alias bashs="exec $SHELL"
alias ipa='curl -s checkip.dyndns.org | grep -Eo "[0-9\.]+" | pbcopy && echo "`pbpaste` (copied to clipboard)"'

# Colors (http://wiki.archlinux.org/index.php/Color_Bash_Prompt)
NO_COLOR='\e[0m'

# Regular
BLACK='\e[0;30m'
RED='\e[0;31m'
GREEN='\e[0;32m'
YELLOW='\e[0;33m'
BLUE='\e[0;34m'
MAGENTA='\e[0;35m'
CYAN='\e[0;36m'
WHITE='\e[0;37m'

# Bold
EBLACK='\e[1;30m'
ERED='\e[1;31m'
EGREEN='\e[1;32m'
EYELLOW='\e[1;33m'
EBLUE='\e[1;34m'
EMAGENTA='\e[1;35m'
ECYAN='\e[1;36m'
EWHITE='\e[1;37m'

# Underlined
UBLACK='\e[4;30m'
URED='\e[4;31m'
UGREEN='\e[4;32m'
UYELLOW='\e[4;33m'
UBLUE='\e[4;34m'
UMAGENTA='\e[4;35m'
UCYAN='\e[4;36m'
UWHITE='\e[4;37m'

# Background
BBLACK='\e[40m'
BRED='\e[41m'
BGREEN='\e[42m'
BYELLOW='\e[43m'
BBLUE='\e[44m'
BMAGENTA='\e[45m'
BCYAN='\e[46m'
BWHITE='\e[47m'

# Terminal Colors

# The color designators:
#  a  black
#  b  red
#  c  green
#  d  brown
#  e  blue
#  f  magenta
#  g  cyan
#  h  light grey
#  A  bold black, usually shows up as dark grey
#  B  bold red
#  C  bold green
#  D  bold brown, usually shows up as yellow
#  E  bold blue
#  F  bold magenta
#  G  bold cyan
#  H  bold light grey; looks like bright white
#  x  default foreground or background

# The order of the attributes are as follows:
#  1.   directory
#  2.   symbolic link
#  3.   socket
#  4.   pipe
#  5.   executable
#  6.   block special
#  7.   character special
#  8.   executable with setuid bit set
#  9.   executable with setgid bit set
#  10.  directory writable to others, with sticky bit
#  11.  directory writable to others, without sticky bit

# The default is "exfxcxdxbxegedabagacad"
export CLICOLOR=1
export LSCOLORS=cxfxcxdxbxegebabagacad

# Command Prompt
PS1="[\t][\u@\h:\w]> "

# PostgreSQL (http://www.postgresql.org)
alias pgs="pg_ctl -D /usr/local/var/postgres -l /usr/local/var/postgres/server.log start"
alias pgq="pg_ctl -D /usr/local/var/postgres stop -s -m fast"

# Apache (http://httpd.apache.org)
alias apachec="mate /etc/apache2/httpd.conf"
alias apachev="mate /private/etc/apache2/extra/httpd-vhosts.conf"
alias apaches="mate /private/etc/apache2/extra/httpd-ssl.conf"
alias apachest="sudo /usr/sbin/apachectl start"
alias apachesp="sudo /usr/sbin/apachectl stop"
alias apacher="sudo /usr/sbin/apachectl restart"

# Git (http://git-scm.com)
alias gst="git status -sb"
alias glast="git show --stat"
alias gg="git grep"
alias gl="git log --oneline --decorate"
alias glh='git log --pretty=format:%H -1 | pbcopy && echo "`pbpaste` (copied to clipboard)"'
alias glc="git shortlog -sne"
alias gld="git log --graph --pretty=format:'%Cred%h%Creset %an: %s - %Creset %C(yellow)%d%Creset %Cgreen(%cr)%Creset' --abbrev-commit --date=relative"
alias gln="git log --name-status"
alias glf="git log ..FETCH_HEAD"
alias gd="git diff"
alias gdw="git diff --word-diff"
alias gb="git branch -v"
alias gm="git merge"
alias gcl="git clone"
alias gch="git checkout"
alias ga="git add"
alias gall="git add ."
alias gco="git commit"
alias gca="git commit -a"
alias gcam="git commit -a -m"
alias gamend="git commit --amend -m"
alias gash="git stash"
alias gf="git fetch"
alias gpu="git pull"
alias gpur="git pull --rebase" # Rebase the current branch on top of the upstream branch after fetching
alias gp="git push"
alias gpo="git push origin"
alias gpp="git push production master"
alias gps="git push stage stage:master"
alias gtag="git tag"
alias gtags="git push --tags"
alias gres="git reset --hard HEAD"
alias grev="git revert"

# GitHub (https://github.com)
# Function Source: https://gist.github.com/1105392
function init_github() {
  git remote add origin git@github.com:$1/$2.git
  git push origin master
  git config branch.master.remote origin
  git config branch.master.merge refs/heads/master
  git config push.default current
}

# Ruby (http://www.ruby-lang.org)
# Reference: http://snaprails.tumblr.com/post/241746095/rubys-gc-configuration.
export RUBY_HEAP_MIN_SLOTS=500000 # Initial/minimum number of heap slots. Default: 10000.
export RUBY_HEAP_SLOTS_INCREMENT=250000 # The number of new slots to allocate when all initial slots are used. Default: 10000.
export RUBY_HEAP_SLOTS_GROWTH_FACTOR=1 # The multiplicator use when new heap slots are required (i.e. RUBY_HEAP_SLOTS_INCREMENT * RUBY_HEAP_SLOTS_GROWTH_FACTOR). Default: 1.8.
export RUBY_GC_MALLOC_LIMIT=50000000 # The number of C data structures that can be allocated before triggering the garbage collector. Default: 8000000.
export RUBY_HEAP_FREE_MIN=100000 # The number of free slots that should be present after GC finishes. If there are fewer slots than those defined it will allocate new ones according to RUBY_HEAP_SLOTS_INCREMENT and RUBY_HEAP_SLOTS_GROWTH_FACTOR parameters. Default: 4096.
alias rd="rdoc -a -o _doc"
alias rdo="open _doc/index.html"

# Executes a specific Test::Unit test file with optional support to 
# ==== Parameters
# * +test_file+ - Required. The Test::Unit file path.
# * +test_name+ - Optional. The Test::Unit name within the file.
function rtest {
  if [ -n "$2" ]; then
    bundle exec ruby -I test "$1" -n "$2"
  else
    bundle exec ruby -I test "$1"
  fi
}

# Ruby Gems (http://rubygems.org)
alias geml="gem list"
alias gemi="gem install"
alias gemup="gem update"
alias gemu="gem uninstall"
alias gemc="gem cleanup"
alias gems="gem server"

# Ruby Gems Whois (https://github.com/jnunemaker/gemwhois)
alias gemw="gem whois"

# Bundler (http://gembundler.com)
alias b="bundle"
alias bi="bundle install"
alias bu="bundle update"
alias bo="bundle outdated"
alias bcon="bundle console"
alias be="bundle exec"
alias ber="bundle exec rspec"
alias bers="bundle exec rspec spec"
alias bec="bundle exec cucumber"
alias bch="rm -f Gemfile.lock; bundle check"
alias rebundle="bch; bundle package"

# Gemsmith (https://github.com/bkuhlmann/gemsmith)
alias g="gemsmith"
alias go="gemsmith -o"

# Heroku+ (https://github.com/bkuhlmann/heroku_plus)
alias hpas="hp -a -s"

# Ruby on Rails (http://rubyonrails.org)
function rew {
  unset $options

  case "$2" in
    "b")
      echo "Rails Base Template."
      echo "Template not implemented. Exiting..."
      return
      ;;
    "s")
      echo "Rails Setup Template."
      options="-d sqlite3 -J -T -f --skip-bundle -m https://raw.github.com/bkuhlmann/rails_setup_template/master/template.rb"
      ;;
    *)
      echo "Rails Default Skeleton."
      unset $options
      ;;
  esac

  rails new $1 $options
}

function sc {
  if [ -e script/rails ]; then
    script/rails console $@
  else
    script/console $@
  fi
}

function ss {
  if [ -e script/rails ]; then
    script/rails server $@
  else
    script/server $@
  fi
}

function sg {
  if [ -e script/rails ]; then
    script/rails generate $@
  else
    script/generate $@
  fi
}

function sdb {
  if [ -e script/rails ]; then
    script/rails dbconsole $@
  else
    script/dbconsole $@
  fi
}

alias scs="sc --sandbox"
alias sgc="sg controller"
alias sgm="sg model"
alias sgs="sg scaffold"
alias rdbd="rake db:drop"
alias rdbc="rake db:create"
alias rdbm="rake db:migrate"
alias rassp="rake assets:precompile"
alias rassc="rake assets:clean"
alias taild="tail -f log/development.log"
alias tailt="tail -f log/test.log"
alias res="touch tmp/restart.txt"
alias debug="rdebug -c"
alias rprofile="ruby-prof --printer=graph_html ./script/rails runner > profile.html"
alias rpaths="rake routes | sed -e "1d" -e "s,^[^/]*,,g" | awk '{print $1}' | sort | uniq"
alias erd="rake erd attributes=primary_keys,foreign_keys,timestamps,inheritance,content inheritance=true orientation=vertical filename=doc/design/models"
alias dmodels="railroady -l -i -a --all-columns -j -t -o doc/design/models.dot -M"
alias dcontrollers="railroady -l -i -o doc/design/controllers.dot -C"
alias dstate="railroady -l -i -o doc/design/state.dot -A"

# Capistrano (https://github.com/capistrano/capistrano)
alias caps="cap stage deploy"
alias capp="cap production deploy"

# Sitemap Generator (https://github.com/kjvarga/sitemap_generator)
alias rsite="rake sitemap:refresh:no_ping"
alias rsitep="rake sitemap:refresh"

# Default Editor
export EDITOR=sublime

# rbenv (https://github.com/sstephenson/rbenv)
if [ -d /usr/local/bin ]; then
  export PATH="/usr/local/bin:$PATH" # OSX
fi

if [ -d $HOME/.rbenv/bin ]; then
  export PATH="$HOME/.rbenv/bin:$PATH" # Ubuntu
fi

eval "$(rbenv init -)"

alias rb="rbenv"
alias rbg="rbenv global"
alias rbl="rbenv local"
alias rbs="rbenv shell"
alias rbh="rbenv rehash"
alias rbw="rbenv which"
alias rbv="rbenv versions"
